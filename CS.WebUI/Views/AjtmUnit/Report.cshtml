
@{
    Layout = "~/Views/Shared/_Content.cshtml";
}
<style>
    .layui-table th {
        text-align: center
    }

    .ReportTitle {
        text-align: center;
        font-size: 30px;
        margin-bottom: 30px;
        margin-top: 20px;
    }
</style>
<div>
    <div class="ReportTitle"><span>市本级机关事业单位机构编制职数情况一览表</span><a target="_blank" href="../AjtmUnit/Export" class="layui-btn layui-btn-sm" style="margin-left:80px"><i class="layui-icon layui-icon-exl layui-icon-small"></i>下载</a></div>
    <table class="layui-table" lay-size="sm" style="text-align:center;width:4000px">
        <colgroup>
            <col width="10">
            <col width="250">
            <col width="10">
            <col width="10">
            <col width="130">
            <col width="60">
            <col width="60">
            <col width="60">
            <col width="110">
            <col width="60">
            <col width="60">
            <col width="60">
            <col width="60">
            <col width="60">
            <col width="60">
            <col width="60">
            <col width="60">
            <col width="60">
            <col width="60">
            <col width="60">
            <col width="60">
            <col width="60">
            <col width="60">
            <col width="60">
            <col width="60">
            <col width="60">
            <col width="60">
            <col width="60">
            <col width="60">
            <col width="60">
            <col width="60">
            <col width="60">
            <col width="60">
            <col width="60">
            <col width="60">
            <col width="60">
            <col width="60">
            <col width="60">
            <col width="60">
            <col width="60">
            <col width="60">
            <col width="60">
            <col width="60">
            <col width="60">
            <col width="60">
            <col width="60">
            <col width="60">
            <col width="60">
            <col width="60">
            <col width="60">
            <col width="60">
            <col width="250">
            <col width="250">
            <col width="250">
            <col width="250">
            <col width="250">
        </colgroup>
        <thead>
            <tr>
                <th rowspan="4">
                    序<br />
                    号
                </th>
                <th rowspan="4">主管单位</th>
                <th colspan="3">单位名称</th>
                <th colspan="5">
                    机构信息
                </th>
                <th colspan="25">编制及人员信息</th>
                <th colspan="16">职数信息</th>
                <th rowspan="4">备注</th>
                <th colspan="4">备注分类别基础数据</th>
            </tr>
            <tr>
                <th colspan="3" rowspan="3">单位名称</th>
                <th rowspan="3">
                    机构性质
                </th>
                <th rowspan="3">
                    机构级别
                </th>
                <th rowspan="3">
                    经费形式
                </th>
                <th rowspan="3">
                    机构类别
                </th>
                <th rowspan="3">
                    参公
                    情况
                </th>
                <th colspan="9">核定编制</th>
                <th colspan="9">实有人员</th>
                <th rowspan="3">领导预留</th>
                <th colspan="4">待上编</th>
                <th rowspan="3">其他预留</th>
                <th rowspan="3">空缺编制</th>
                <th colspan="8">领导职数</th>
                <th colspan="8">中层职数</th>
                <th rowspan="3">待上编备注</th>
                <th rowspan="3">领导预留备注</th>
                <th rowspan="3">其他预留备注</th>
                <th rowspan="3">其他备注</th>
            </tr>
            <tr>
                <th colspan="2"> 行政</th>
                <th colspan="4"> 事业</th>
                <th rowspan="2"> 工勤</th>
                <th rowspan="2">
                    政府雇员
                </th>
                <th rowspan="2">
                    员额控制数
                </th>
                <th colspan="2"> 行政</th>
                <th colspan="4"> 事业</th>
                <th rowspan="2"> 工勤</th>
                <th rowspan="2">
                    政府雇员
                </th>
                <th rowspan="2">
                    员额控制数
                </th>
                <th rowspan="2">行政编制</th>
                <th rowspan="2">事业编制</th>
                <th rowspan="2">工勤控制数</th>
                <th rowspan="2">政府雇员</th>
                <th colspan="3">职数数量</th>
                <th colspan="5">核定职数级别</th>
                <th colspan="4">职数数量</th>
                <th colspan="4">核定职数级别</th>

            </tr>
            <tr>
                <th>
                    一般行政
                </th>
                <th>
                    政法专项
                </th>
                <th>
                    参公事业
                </th>
                <th>
                    一般事业
                </th>
                <th>
                    周转事业
                </th>
                <th>
                    储备事业
                </th>
                <th>
                    一般行政
                </th>
                <th>
                    政法专项
                </th>
                <th>
                    参公事业
                </th>
                <th>
                    一般事业
                </th>
                <th>
                    周转事业
                </th>
                <th>
                    储备事业
                </th>
                <th>
                    核定
                </th>
                <th>
                    实配
                </th>
                <th>
                    空缺
                </th>
                <th>
                    副厅
                </th>
                <th>
                    正县
                </th>
                <th>
                    副县
                </th>
                <th>
                    正科
                </th>
                <th>
                    副科
                </th>
                <th>
                    正职核定
                </th>
                <th>
                    正职实配
                </th>
                <th>
                    副职核定
                </th>
                <th>
                    副职实配
                </th>
                <th>
                    正县
                </th>
                <th>
                    副县
                </th>
                <th>
                    正科
                </th>
                <th>
                    副科
                </th>
            </tr>
        </thead>
        <tbody>
            @foreach (System.Data.DataRow row in ViewBag.UnitInfo.Rows)
            {
                var isBool = (row["PARENT_ID"].ToString() == row["ID"].ToString()) ? true : false;
            <tr>
                <td>@row["ID"]</td>
                @if (isBool)
                {
                    <td>@row["PANRET_NAME"]</td>
                    <td colspan="3" data-index='@row["PARENT_ID"]'>@row["NAME"]</td>
                }
                else
                {
                    <td>@row["NO1"]</td>
                    <td>@row["NO2"]</td>
                    <td data-count="@row["PARENT_ID"]">@row["NAME"]</td>
                }
                <td>@row["SETUP_TYPE"]</td>
                <td>@row["SETUP_LEVEL"]</td>
                <td>@row["OUTLAY_MODE"]</td>
                <td>@row["SETUP_NATRUE"]</td>
                <td>@row["IS_PUBLIC"]</td>
                <td>@row["XZ_YBXZ_NUM"]</td>
                <td>@row["XZ_ZFZX_NUM"]</td>
                <td>@row["SY_YBSY_NUM"]</td>
                <td>@row["SY_CGSY_NUM"]</td>
                <td>@row["SY_CBSY_NUM"]</td>
                <td>@row["SY_ZZSY_NUM"]</td>
                <td>@row["GQ_KZ_NUM"]</td>
                <td>@row["ZF_KY_NUM"]</td>
                <td>@row["YR_KY_NUM"]</td>
                <td>@row["P_XZ_YBXZ_NUM"]</td>
                <td>@row["P_XZ_ZFZX_NUM"]</td>
                <td>@row["P_SY_YBSY_NUM"]</td>
                <td>@row["P_SY_CGSY_NUM"]</td>
                <td>@row["P_SY_CBSY_NUM"]</td>
                <td>@row["P_SY_ZZSY_NUM"]</td>
                <td>@row["P_GQ_KZ_NUM"]</td>
                <td>@row["P_ZF_KY_NUM"]</td>
                <td>@row["P_YR_KY_NUM"]</td>
                <td>@row["LEADER_RESVEST_NUM"]</td>
                <td>@row["D_XZ_NUM"]</td>
                <td>@row["D_SY_YBSY_NUM"]</td>
                @*<td>@row["D_SY_CGSY_NUM"]</td>*@
                <td>@row["D_GQ_KZ_NUM"]</td>
                <td>@row["D_ZF_KY_NUM"]</td>
                <td>@row["RESERVE_NUM"]</td>
                <td>空缺编制</td>
                <td>@row["LEADER_UNIT_NUM"]</td>
                <td>@row["LEADER_SJ_NUM"]</td>
                <td>@row["LEADER_NULL_NUM"]</td>
                @*<td>@row["OFFICE_MIAN_NUM"]</td>*@
                <td>@row["OFFICE_VICE_NUM"]</td>
                <td>@row["COUNTY_MIAN_L"]</td>
                <td>@row["COUNTY_VICE_L"]</td>
                <td>@row["VILLAGE_MIAN_L"]</td>
                <td>@row["VILLAGE_VICE_L"]</td>
                <td>@row["WITHIN_MAIN_NUM"]</td>
                <td>@row["WITHIN_MAIN_SP_NUM"]</td>
                <td>@row["WITHIN_VICE_NUM"]</td>
                <td>@row["WITHIN_VICE_SP_NUM"]</td>
                <td>@row["COUNTY_MIAN_MR"]</td>
                <td>@row["COUNTY_VICE_MR"]</td>
                <td>@row["VILLAGE_MIAN_MR"]</td>
                <td>@row["VILLAGE_VICE_MR"]</td>
                <td>@row["TOTAL_REMARK"]</td>
                <td>@row["AS_DETAIL_REAMRK"]</td>
                <td>@row["LEADER_REAMRK"]</td>
                <td>@row["RESERVE_REAMRK"]</td>
                <td>@row["REMARK"]</td>
            </tr>
            }

        </tbody>

    </table>

    @*<table lay-filter="demo"></table>*@
</div>
<script>
    $("td[data-index]").each(function (i, e) {
        var id = $(e).attr("data-index");
        var count = $("td[data-count='" + id + "']").length;
        $(e).prev().attr("rowspan", count + 1);
    });
</script>
